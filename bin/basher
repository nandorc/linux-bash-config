#!/bin/bash

# Dependencies
source ~/.basher/etc/colors.sh
source ~/.basher/lib/flagger.sh

# Get command data
commands_array=(${1//:/ })
command_name=${commands_array[0]}
[ -z "$command_name" ] && echo -e "\n"$color_red"Execution Exception: "$color_none"No parameters received\nUse "$color_yellow"basher help"$color_none" to know how to use the tool\n" && exit 1
[ ! -d ~/.basher/src/"$command_name"/cmd ] && echo -e "\n"$color_red"Execution Exception: "$color_yellow"$command_name"$color_none" is not a valid executable command\nUse "$color_yellow"basher help:list"$color_none" to get the list of commands\n" && exit 1
command_action=${commands_array[1]}
[ -z "$command_action" ] && [ -f ~/.basher/src/"$command_name"/cmd/default.sh ] && command_action="default"
[ -z "$command_action" ] && echo -e "\n"$color_red"Execution Exception: "$color_none" No valid action received for "$color_yellow"$command_name"$color_none" command\nUse "$color_yellow"basher help $command_name"$color_none" to know how to use it\n" && exit 1
[ ! -f ~/.basher/src/"$command_name"/cmd/"$command_action".sh ] && echo -e "\n"$color_red"Execution Exception: "$color_none"Command "$color_yellow"basher $command_name:$command_action"$color_none" not found\nUse "$color_yellow"basher help $command_name"$color_none" to read more about it\n" && exit 1
command_options=$(pruneFlag $1 $*)

# Send command
~/.basher/src/"$command_name"/cmd/"$command_action".sh $command_options
