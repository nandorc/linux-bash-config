#!/bin/bash

# Load dependencies
source ~/.bash_utilities/lib/ext/dsoft/messages.sh

# Get and Process inputs
. ~/.bash_utilities/src/setpermissions/src/getinputs.sh
if [ $showhelp -eq 1 ]; then
    mdv ~/.bash_utilities/src/setpermissions/README.md
elif [ -z "$path" ]; then
    printErrorMessage "A path to a file/folder must be specified to apply permissions" both
elif [ ! -d "$path" ] && [ ! -f "$path" ]; then
    printErrorMessage "Not an existing file or folder at $path" both
else
    . ~/.bash_utilities/src/setpermissions/src/setownership.sh "$path" "$ownername" "$groupname"
    . ~/.bash_utilities/src/setpermissions/src/setexefiles.sh "$path" "$exeperm"
    . ~/.bash_utilities/src/setpermissions/src/setregfiles.sh "$path" "$filperm" "$exeperm"
    . ~/.bash_utilities/src/setpermissions/src/setfolders.sh "$path" "$ownername" "$groupname"
    printInfoMessage "all done" both
fi

# Clean inputs
unset ownername groupname filperm dirperm exeperm path
